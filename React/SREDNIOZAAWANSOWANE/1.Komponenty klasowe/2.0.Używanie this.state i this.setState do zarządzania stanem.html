<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Używanie this.state i this.setState w React</title>
    <link rel="stylesheet" href="/React/styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
</head>
<body>
    <div class="container">
        <h1>Używanie <code>this.state</code> i <code>this.setState</code> w React</h1>

        <p>W klasowych komponentach React, stan jest zarządzany za pomocą <code>this.state</code>, a jego aktualizacja odbywa się przy użyciu metody <code>this.setState</code>. Stan (ang. <em>state</em>) to dane, które mogą zmieniać się w trakcie działania komponentu, w wyniku interakcji użytkownika lub innych czynników.</p>

        <h2>Inicjalizacja stanu za pomocą <code>this.state</code></h2>
        <p>Stan komponentu jest zazwyczaj inicjalizowany w konstruktorze klasy przy pomocy obiektu <code>this.state</code>. Na przykład, poniżej znajduje się komponent, który ma stan <code>count</code>, zainicjalizowany wartością <code>0</code>:</p>
        
        <pre><code class="language-javascript">
class Counter extends React.Component &#123;
  constructor(props) &#123;
    super(props);
    // Inicjalizacja stanu
    this.state = &#123; count: 0 &#125;;
  &#125;

  render() &#123;
    return (
      &lt;div&gt;
        &lt;p&gt;Kliknięto &#123;this.state.count&#125; razy&lt;/p&gt;
        &lt;button&gt;Kliknij mnie&lt;/button&gt;
      &lt;/div&gt;
    );
  &#125;
&#125;

ReactDOM.render(&lt;Counter /&gt;, document.getElementById('root'));
        </code></pre>

        <p>W powyższym przykładzie stan <code>count</code> został zainicjalizowany w konstruktorze. <code>this.state.count</code> jest używane w metodzie <code>render</code>, aby wyświetlić aktualną wartość stanu.</p>

        <h2>Aktualizowanie stanu za pomocą <code>this.setState</code></h2>
        <p>Jeśli chcemy zaktualizować stan w odpowiedzi na interakcję użytkownika, na przykład po kliknięciu przycisku, używamy metody <code>this.setState</code>. Oto jak to działa:</p>

        <pre><code class="language-javascript">
class Counter extends React.Component &#123;
  constructor(props) &#123;
    super(props);
    // Inicjalizacja stanu
    this.state = &#123; count: 0 &#125;;
    // Powiązanie metody
    this.handleClick = this.handleClick.bind(this);
  &#125;

  // Funkcja obsługująca kliknięcie, aktualizująca stan
  handleClick() &#123;
    this.setState((prevState) => (&#123;
      count: prevState.count + 1
    &#125;));
  &#125;

  render() &#123;
    return (
      &lt;div&gt;
        &lt;p&gt;Kliknięto &#123;this.state.count&#125; razy&lt;/p&gt;
        &lt;button onClick=&#123;this.handleClick&#125;&gt;Kliknij mnie&lt;/button&gt;
      &lt;/div&gt;
    );
  &#125;
&#125;

ReactDOM.render(&lt;Counter /&gt;, document.getElementById('root'));
        </code></pre>

        <p>W tym przykładzie metoda <code>this.setState</code> jest używana w metodzie <code>handleClick</code>, aby zaktualizować stan <code>count</code> po każdym kliknięciu. Używamy tutaj funkcji strzałkowej <code>(prevState)</code>, aby zapewnić, że aktualizacja stanu będzie oparta na poprzedniej wartości <code>count</code>.</p>

        <h2>Dlaczego używamy <code>this.setState</code>?</h2>
        <p>React wymaga użycia <code>this.setState</code>, aby poprawnie zarządzać aktualizacją stanu. Nie powinno się bezpośrednio modyfikować <code>this.state</code>, ponieważ może to prowadzić do niespójności w renderowaniu komponentu. Na przykład:</p>

        <pre><code class="language-javascript">
class Counter extends React.Component &#123;
  constructor(props) &#123;
    super(props);
    this.state = &#123; count: 0 &#125;;
  &#125;

  // Nieprawidłowa metoda aktualizacji stanu
  handleClick() &#123;
    this.state.count += 1; // Bezpośrednia modyfikacja stanu - nieprawidłowe
    this.forceUpdate(); // Wymuszanie aktualizacji (niezalecane)
  &#125;

  render() &#123;
    return (
      &lt;div&gt;
        &lt;p&gt;Kliknięto &#123;this.state.count&#125; razy&lt;/p&gt;
        &lt;button onClick=&#123;() => this.handleClick()&#125;&gt;Kliknij mnie&lt;/button&gt;
      &lt;/div&gt;
    );
  &#125;
&#125;
        </code></pre>

        <p>Bezpośrednia modyfikacja <code>this.state</code> i używanie <code>this.forceUpdate</code> nie jest zalecane, ponieważ może prowadzić do nieprzewidywalnych zachowań komponentu. Zamiast tego należy zawsze używać <code>this.setState</code>, aby React mógł odpowiednio zaktualizować i ponownie renderować komponent.</p>

        <h2>Asynchroniczna natura <code>this.setState</code></h2>
        <p>Warto zauważyć, że <code>this.setState</code> może działać asynchronicznie, co oznacza, że nie należy polegać na natychmiastowej aktualizacji stanu po jego wywołaniu. Z tego powodu zaleca się używanie funkcji jako argumentu w <code>this.setState</code>, aby uzyskać najnowszy stan. Na przykład:</p>

        <pre><code class="language-javascript">
class Counter extends React.Component &#123;
  constructor(props) &#123;
    super(props);
    this.state = &#123; count: 0 &#125;;
  &#125;

  // Funkcja aktualizująca stan
  increment() &#123;
    this.setState((prevState) => (&#123;
      count: prevState.count + 1
    &#125;));
  &#125;

  render() &#123;
    return (
      &lt;div&gt;
        &lt;p&gt;Kliknięto &#123;this.state.count&#125; razy&lt;/p&gt;
        &lt;button onClick=&#123;() => this.increment()&#125;&gt;Kliknij mnie&lt;/button&gt;
      &lt;/div&gt;
    );
  &#125;
&#125;

ReactDOM.render(&lt;Counter /&gt;, document.getElementById('root'));
        </code></pre>

        <p>W tym przykładzie aktualizujemy stan za pomocą funkcji <code>prevState</code>, co zapewnia, że odwołujemy się do najnowszego stanu podczas aktualizacji.</p>

        <h2>Podsumowanie</h2>
        <p>W komponentach klasowych w React stan jest zarządzany za pomocą <code>this.state</code> i aktualizowany za pomocą <code>this.setState</code>. Użycie <code>this.setState</code> pozwala React na odpowiednie śledzenie zmian i aktualizację interfejsu użytkownika. Unikaj bezpośredniej modyfikacji stanu oraz pamiętaj, że <code>this.setState</code> działa asynchronicznie, dlatego warto korzystać z funkcji <code>prevState</code>, gdy potrzebujemy dokładnej wartości poprzedniego stanu.</p>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-javascript.min.js"></script>
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
</body>
</html>
