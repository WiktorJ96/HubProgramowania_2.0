<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metody cyklu życia komponentów w React</title>
    <link rel="stylesheet" href="/React/styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
</head>
<body>
    <div class="container">
        <h1>Metody cyklu życia komponentów w React</h1>

        <p>Komponenty klasowe w React oferują szereg metod cyklu życia, które pozwalają na wykonywanie kodu na różnych etapach życia komponentu. Do najważniejszych metod cyklu życia należą: <strong>componentDidMount</strong>, <strong>componentDidUpdate</strong> oraz <strong>componentWillUnmount</strong>. Używane są one głównie do zarządzania zasobami, obsługi efektów ubocznych oraz reagowania na zmiany w komponentach.</p>

        <h2><code>componentDidMount</code></h2>
        <p>Metoda <code>componentDidMount</code> jest wywoływana po tym, jak komponent został zamontowany (tj. po pierwszym renderowaniu). Jest to dobre miejsce na wykonywanie operacji takich jak pobieranie danych z API, subskrypcje oraz inne efekty uboczne, które powinny zostać zainicjowane po załadowaniu komponentu.</p>

        <pre><code class="language-javascript">
class MyComponent extends React.Component &#123;
  componentDidMount() &#123;
    // Kod wykonywany po zamontowaniu komponentu
    console.log('Komponent został zamontowany');
  &#125;

  render() &#123;
    return (
      &lt;div&gt;
        &lt;p&gt;Komponent został zamontowany.&lt;/p&gt;
      &lt;/div&gt;
    );
  &#125;
&#125;

ReactDOM.render(&lt;MyComponent /&gt;, document.getElementById('root'));
        </code></pre>

        <p>W powyższym przykładzie metoda <code>componentDidMount</code> wyświetla komunikat w konsoli, gdy komponent zostanie zamontowany.</p>

        <h2><code>componentDidUpdate</code></h2>
        <p>Metoda <code>componentDidUpdate</code> jest wywoływana za każdym razem, gdy komponent został zaktualizowany, np. po zmianie jego stanu (<code>state</code>) lub właściwości (<code>props</code>). Można ją wykorzystać do reagowania na zmiany danych i ponownego pobierania informacji, jeśli komponent został zaktualizowany z nowymi danymi.</p>

        <pre><code class="language-javascript">
class Counter extends React.Component &#123;
  constructor(props) &#123;
    super(props);
    this.state = &#123; count: 0 &#125;;
  &#125;

  componentDidUpdate(prevProps, prevState) &#123;
    if (prevState.count !== this.state.count) &#123;
      console.log('Stan został zaktualizowany: ', this.state.count);
    &#125;
  &#125;

  increment = () => &#123;
    this.setState((prevState) => (&#123; count: prevState.count + 1 &#125;));
  &#125;

  render() &#123;
    return (
      &lt;div&gt;
        &lt;p&gt;Licznik: &#123;this.state.count&#125;&lt;/p&gt;
        &lt;button onClick=&#123;this.increment&#125;&gt;Zwiększ licznik&lt;/button&gt;
      &lt;/div&gt;
    );
  &#125;
&#125;

ReactDOM.render(&lt;Counter /&gt;, document.getElementById('root'));
        </code></pre>

        <p>W tym przykładzie metoda <code>componentDidUpdate</code> porównuje poprzedni stan (<code>prevState</code>) z bieżącym stanem i wyświetla komunikat w konsoli, gdy wartość <code>count</code> się zmieni.</p>

        <h2><code>componentWillUnmount</code></h2>
        <p>Metoda <code>componentWillUnmount</code> jest wywoływana tuż przed odmontowaniem (usunięciem) komponentu z drzewa DOM. Jest to miejsce, w którym możemy wykonać operacje czyszczenia, takie jak anulowanie subskrypcji, zatrzymanie odliczania czasu (timery) lub usunięcie zasobów, które zostały zainicjowane w <code>componentDidMount</code>.</p>

        <pre><code class="language-javascript">
class Timer extends React.Component &#123;
  constructor(props) &#123;
    super(props);
    this.state = &#123; time: 0 &#125;;
    this.timer = null;
  &#125;

  componentDidMount() &#123;
    // Uruchomienie licznika po zamontowaniu komponentu
    this.timer = setInterval(() => &#123;
      this.setState((prevState) => (&#123; time: prevState.time + 1 &#125;));
    &#125;, 1000);
  &#125;

  componentWillUnmount() &#123;
    // Czyszczenie licznika przed odmontowaniem komponentu
    clearInterval(this.timer);
    console.log('Komponent został odmontowany i licznik zatrzymany.');
  &#125;

  render() &#123;
    return (
      &lt;div&gt;
        &lt;p&gt;Czas: &#123;this.state.time&#125; sekund&lt;/p&gt;
      &lt;/div&gt;
    );
  &#125;
&#125;

ReactDOM.render(&lt;Timer /&gt;, document.getElementById('root'));
        </code></pre>

        <p>W tym przykładzie metoda <code>componentWillUnmount</code> zatrzymuje licznik (interval), który został uruchomiony w <code>componentDidMount</code>, aby zapobiec wyciekom zasobów.</p>

        <h2>Kiedy używać tych metod cyklu życia?</h2>
        <ul>
            <li><strong>componentDidMount:</strong> Używaj, gdy chcesz wykonać kod po zamontowaniu komponentu, np. pobieranie danych, subskrypcje, uruchomienie liczników.</li>
            <li><strong>componentDidUpdate:</strong> Używaj, gdy musisz zareagować na zmiany danych w stanie lub propsach, np. aby ponownie pobrać dane, gdy parametry zmienią się.</li>
            <li><strong>componentWillUnmount:</strong> Używaj do sprzątania po komponencie przed jego odmontowaniem, np. zatrzymywanie timerów, usuwanie subskrypcji.</li>
        </ul>

        <h2>Podsumowanie</h2>
        <p>Metody cyklu życia w komponentach klasowych w React umożliwiają wykonywanie operacji na różnych etapach istnienia komponentu. <code>componentDidMount</code> jest wywoływane po zamontowaniu, <code>componentDidUpdate</code> po każdej aktualizacji, a <code>componentWillUnmount</code> przed odmontowaniem komponentu. Te metody są kluczowe do zarządzania zasobami oraz reagowania na zmiany w aplikacji.</p>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-javascript.min.js"></script>
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
</body>
</html>
