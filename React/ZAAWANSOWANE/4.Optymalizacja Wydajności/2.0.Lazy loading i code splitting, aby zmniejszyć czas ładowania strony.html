<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lazy loading i code splitting w React</title>
    <link rel="stylesheet" href="/React/styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
</head>
<body>
    <div class="container">
        <h1>Lazy loading i code splitting w React</h1>

        <p>W nowoczesnych aplikacjach React, optymalizacja wydajności jest kluczowa. Jedną z metod poprawy wydajności i czasu ładowania strony jest **code splitting** (dzielenie kodu) i **lazy loading** (leniwe ładowanie) komponentów. Te techniki pozwalają na ładowanie tylko tych części aplikacji, które są potrzebne w danym momencie, co zmniejsza początkowy rozmiar paczki JavaScript i przyspiesza ładowanie.</p>

        <h2>Co to jest code splitting?</h2>
        <p>**Code splitting** polega na dzieleniu aplikacji na mniejsze paczki (chunks), które są ładowane asynchronicznie tylko wtedy, gdy są potrzebne. React wspiera code splitting natywnie za pomocą dynamicznego importu oraz mechanizmów takich jak <code>React.lazy</code> i <code>Suspense</code>.</p>

        <h2>Lazy loading z <code>React.lazy</code></h2>
        <p>**Lazy loading** to technika ładowania komponentów w momencie, gdy są potrzebne, a nie przy starcie aplikacji. Możemy to osiągnąć za pomocą <code>React.lazy</code>, które dynamicznie importuje komponent. Oto przykład:</p>

        <pre><code class="language-javascript">
        import React, &#123; Suspense &#125; from 'react';

        // Lazy loading komponentu
        const LazyLoadedComponent = React.lazy(() => import('./LazyComponent'));

        function App() &#123;
          return (
            &lt;div&gt;
              &lt;h1&gt;Moja aplikacja&lt;/h1&gt;
              &lt;Suspense fallback=&#123;&lt;p&gt;Ładowanie...&lt;/p&gt;&#125;&gt;
                &lt;LazyLoadedComponent /&gt;  {/* Komponent ładowany leniwie */}
              &lt;/Suspense&gt;
            &lt;/div&gt;
          );
        &#125;

        export default App;
        </code></pre>

        <p>W tym przykładzie komponent <code>LazyLoadedComponent</code> jest ładowany tylko wtedy, gdy zostanie potrzebny. <code>React.lazy</code> działa w połączeniu z komponentem <code>Suspense</code>, który umożliwia wyświetlenie fallbacku (np. komunikatu "Ładowanie...") podczas ładowania komponentu.</p>

        <h2><code>Suspense</code> i fallback</h2>
        <p><code>Suspense</code> działa jak opakowanie dla komponentów ładowanych leniwie, pokazując element zastępczy (fallback), dopóki komponent nie zostanie w pełni załadowany. W przykładzie powyżej element <code>&lt;p&gt;Ładowanie...&lt;/p&gt;</code> jest wyświetlany podczas ładowania <code>LazyLoadedComponent</code>.</p>

        <h2>Code splitting w routingu</h2>
        <p>Code splitting można także zastosować do nawigacji, aby ładować tylko te komponenty, które są potrzebne dla danej trasy. Oto przykład integracji code splittingu z React Router:</p>

        <pre><code class="language-javascript">
        import React, &#123; Suspense &#125; from 'react';
        import &#123; BrowserRouter as Router, Route, Switch &#125; from 'react-router-dom';

        // Lazy loading komponentów
        const Home = React.lazy(() => import('./Home'));
        const About = React.lazy(() => import('./About'));
        const Contact = React.lazy(() => import('./Contact'));

        function App() &#123;
          return (
            &lt;Router&gt;
              &lt;Suspense fallback=&#123;&lt;p&gt;Ładowanie...&lt;/p&gt;&#125;&gt;
                &lt;Switch&gt;
                  &lt;Route path="/" exact component=&#123;Home&#125; /&gt;
                  &lt;Route path="/about" component=&#123;About&#125; /&gt;
                  &lt;Route path="/contact" component=&#123;Contact&#125; /&gt;
                &lt;/Switch&gt;
              &lt;/Suspense&gt;
            &lt;/Router&gt;
          );
        &#125;

        export default App;
        </code></pre>

        <p>W tym przykładzie komponenty <code>Home</code>, <code>About</code> i <code>Contact</code> są ładowane tylko wtedy, gdy użytkownik odwiedzi odpowiednią trasę. Dzięki temu oszczędzamy zasoby i ładowanie strony staje się szybsze.</p>

        <h2>Korzyści z lazy loadingu i code splittingu</h2>
        <p>Korzyści z używania lazy loadingu i code splittingu w React:</p>
        <ul>
          <li>**Szybsze ładowanie strony** – początkowy rozmiar paczki JavaScript jest mniejszy, ponieważ ładowane są tylko te komponenty, które są aktualnie potrzebne.</li>
          <li>**Mniejsze zużycie zasobów** – ładowane są tylko te części aplikacji, które użytkownik faktycznie wykorzystuje.</li>
          <li>**Zoptymalizowana wydajność** – aplikacja działa płynniej, szczególnie w przypadku większych aplikacji.</li>
        </ul>

        <h2>Dynamiczny import</h2>
        <p>Podstawą lazy loadingu jest **dynamiczny import** za pomocą funkcji <code>import()</code>. React automatycznie tworzy osobne paczki (chunks) dla każdego importowanego dynamicznie modułu.</p>

        <pre><code class="language-javascript">
// Dynamiczny import modułu
const LazyLoadedComponent = React.lazy(() => import('./LazyComponent'));
        </code></pre>

        <p>Ta technika pozwala na dynamiczne ładowanie modułów i automatyczne dzielenie kodu.</p>

        <h2>Podział kodu na poziomie funkcji</h2>
        <p>Code splitting nie musi być stosowany wyłącznie na poziomie komponentów. Możemy również dzielić kod na poziomie funkcji, na przykład, aby załadować tylko niezbędne moduły w danym momencie:</p>

        <pre><code class="language-javascript">
        function handleClick() &#123;
          import('./analytics').then(analytics => &#123;
            analytics.trackUser();
          &#125;);
        &#125;
        </code></pre>

        <p>W tym przykładzie kod modułu <code>analytics</code> zostanie załadowany dopiero, gdy użytkownik kliknie przycisk. Dzięki temu kod, który nie jest potrzebny podczas inicjalizacji aplikacji, nie obciąża ładowania.</p>

        <h2>Preloading komponentów</h2>
        <p>Jeśli chcemy, aby komponent został załadowany wcześniej, np. przed tym, jak użytkownik go odwiedzi, możemy użyć techniki preloading (wstępnego ładowania). Możemy to osiągnąć np. w momencie, gdy użytkownik najedzie kursorem na przycisk prowadzący do nowej trasy:</p>

        <pre><code class="language-javascript">
        function handleMouseEnter() &#123;
          import('./HeavyComponent');
        &#125;

        &lt;button onMouseEnter=&#123;handleMouseEnter&#125;&gt;Naładuj komponent&lt;/button&gt;
        </code></pre>

        <p>W tym przykładzie komponent zostanie załadowany w tle, gdy użytkownik najedzie kursorem na przycisk, dzięki czemu po kliknięciu komponent będzie już gotowy do renderowania.</p>

        <h2>Podsumowanie</h2>
        <p>**Lazy loading** i **code splitting** to potężne techniki w React, które pozwalają na optymalizację ładowania aplikacji. Dzięki nim można dzielić kod na mniejsze fragmenty i ładować tylko te części, które są aktualnie potrzebne. W połączeniu z <code>React.lazy</code> i <code>Suspense</code> możemy tworzyć dynamiczne i wydajne aplikacje, które działają płynnie nawet przy większych rozmiarach.</p>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-javascript.min.js"></script>
</body>
</html>
