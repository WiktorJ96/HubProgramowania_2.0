<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React - Redux</title>
    <link rel="stylesheet" href="../styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
</head>
<body>
    <div class="container">
        <h1>React - Redux</h1>
        
        <p>Redux to biblioteka do zarzƒÖdzania stanem aplikacji. U≈ºywa centralnego magazynu (store), w kt√≥rym przechowuje stan aplikacji, pozwalajƒÖc na sp√≥jne zarzƒÖdzanie danymi oraz ich ≈ÇatwƒÖ aktualizacjƒô za pomocƒÖ akcji i reducer√≥w.</p>

        <h2>Instalacja Redux</h2>
        <p>Aby u≈ºyƒá Redux w aplikacji React, nale≈ºy zainstalowaƒá pakiety <code>redux</code> oraz <code>react-redux</code>:</p>

        <pre><code class="language-bash">
npm install redux react-redux
        </code></pre>

        <details>
          <summary class="viz-title">üì¶ Wizualizacja: instalacja i zale≈ºno≈õci</summary>
          <div class="viz-wrap">
            <svg viewBox="0 0 1000 260" class="viz-svg" aria-label="Instalacja redux/react-redux">
              <defs>
                <marker id="arr-install" markerWidth="12" markerHeight="12" refX="10" refY="6" orient="auto">
                  <path d="M0,0 L12,6 L0,12 Z" fill="#94a3b8"></path>
                </marker>
              </defs>
              <g class="lane" transform="translate(10,10)">
                <rect width="980" height="240" rx="12"></rect>
                <text x="16" y="28" class="lane-title">npm install redux react-redux</text>

                <g class="node" transform="translate(20,60)">
                  <rect width="300" height="70" rx="10"></rect>
                  <text x="12" y="26">Twoja aplikacja (React)</text>
                  <text x="12" y="48" class="muted">src/*</text>
                </g>

                <path class="arrow" d="M320,95 L470,95" marker-end="url(#arr-install)"/>
                <g class="pill" transform="translate(470,60)">
                  <rect width="220" height="70" rx="10"></rect>
                  <text x="12" y="26">redux</text>
                  <text x="12" y="48" class="muted">createStore / reducer</text>
                </g>

                <path class="arrow" d="M690,95 L920,95" marker-end="url(#arr-install)"/>
                <g class="ok" transform="translate(700,60)">
                  <rect width="260" height="70" rx="10"></rect>
                  <text x="12" y="26">react-redux</text>
                  <text x="12" y="48" class="muted">Provider / useSelector / useDispatch</text>
                </g>

                <g class="warn" transform="translate(20,150)">
                  <rect width="940" height="60" rx="10"></rect>
                  <text x="12" y="24">Po instalacji opakowujesz aplikacjƒô w &lt;Provider store={store} /&gt; i u≈ºywasz hook√≥w w komponentach.</text>
                </g>
              </g>
            </svg>
          </div>
        </details>

        <h2>Tworzenie Store</h2>
        <p><code>Store</code> to centralny magazyn, w kt√≥rym przechowywany jest stan aplikacji. Jest tworzony za pomocƒÖ funkcji <code>createStore</code> i przyjmuje reducer jako argument.</p>

        <pre><code class="language-javascript">
import { createStore } from 'redux';
import counterReducer from './reducers/counterReducer';

const store = createStore(counterReducer);

export default store;
        </code></pre>

        <details open>
          <summary class="viz-title">üè™ Wizualizacja: Store + Reducer + State</summary>
          <div class="viz-wrap">
            <svg viewBox="0 0 1000 360" class="viz-svg" aria-label="Struktura store">
              <defs>
                <marker id="arr-store" markerWidth="12" markerHeight="12" refX="10" refY="6" orient="auto">
                  <path d="M0,0 L12,6 L0,12 Z" fill="#94a3b8"></path>
                </marker>
              </defs>

              <g class="lane" transform="translate(10,10)">
                <rect width="980" height="340" rx="12"></rect>
                <text x="16" y="28" class="lane-title">createStore(counterReducer) ‚Üí jeden ≈∫r√≥d≈Çowy stan</text>

                <g class="node" transform="translate(20,60)">
                  <rect width="300" height="80" rx="10"></rect>
                  <text x="12" y="26">counterReducer(state, action)</text>
                  <text x="12" y="48" class="muted">funkcja czysta</text>
                </g>

                <path class="arrow" d="M320,100 L450,100" marker-end="url(#arr-store)"/>

                <g class="pill" transform="translate(450,60)">
                  <rect width="200" height="80" rx="10"></rect>
                  <text x="12" y="26">createStore</text>
                  <text x="12" y="48" class="muted">Redux</text>
                </g>

                <path class="arrow" d="M650,100 L900,100" marker-end="url(#arr-store)"/>

                <g class="ok" transform="translate(670,60)">
                  <rect width="300" height="80" rx="10"></rect>
                  <text x="12" y="26">store</text>
                  <text x="12" y="48" class="muted">getState / dispatch / subscribe</text>
                </g>

                <g transform="translate(20,170)">
                  <foreignObject width="940" height="150">
                    <div xmlns="http://www.w3.org/1999/xhtml">
                      <table class="db-table">
                        <caption class="mini">Co posiada <code>store</code>?</caption>
                        <thead><tr><th>Metoda</th><th>Opis</th></tr></thead>
                        <tbody>
                          <tr><td>getState()</td><td>Zwraca aktualny stan</td></tr>
                          <tr><td>dispatch(action)</td><td>Wysy≈Ça akcjƒô do reducera ‚Üí nowy stan</td></tr>
                          <tr><td>subscribe(listener)</td><td>Rejestruje listener wywo≈Çywany przy zmianie stanu</td></tr>
                        </tbody>
                      </table>
                    </div>
                  </foreignObject>
                </g>
              </g>
            </svg>
          </div>
        </details>

        <p>W tym przyk≈Çadzie store jest tworzony z u≈ºyciem <code>counterReducer</code>, kt√≥ry zarzƒÖdza stanem licznika.</p>

        <h2>Akcje</h2>
        <p>Akcje to obiekty opisujƒÖce, co ma siƒô wydarzyƒá w aplikacji. ZawierajƒÖ typ (opis akcji) i opcjonalnie dane, kt√≥re majƒÖ byƒá przekazane do reducera.</p>

        <pre><code class="language-javascript">
// Definicja akcji zwiƒôkszajƒÖcej licznik
export const increment = () => ({
    type: 'INCREMENT'
});

// Definicja akcji zmniejszajƒÖcej licznik
export const decrement = () => ({
    type: 'DECREMENT'
});
        </code></pre>

        <details>
          <summary class="viz-title">üéØ Wizualizacja: kszta≈Çt akcji</summary>
          <div class="viz-wrap">
            <svg viewBox="0 0 1000 260" class="viz-svg" aria-label="Akcja Redux">
              <g class="lane" transform="translate(10,10)">
                <rect width="980" height="240" rx="12"></rect>
                <text x="16" y="28" class="lane-title">Action = zwyk≈Çy obiekt JS</text>

                <g transform="translate(20,60)">
                  <foreignObject width="460" height="160">
                    <div xmlns="http://www.w3.org/1999/xhtml">
                      <table class="db-table">
                        <thead><tr><th>Pole</th><th>Opis</th></tr></thead>
                        <tbody>
                          <tr><td>type</td><td>ObowiƒÖzkowy string identyfikujƒÖcy akcjƒô, np. <code>'INCREMENT'</code></td></tr>
                          <tr><td>payload</td><td>(opcjonalnie) dane potrzebne do aktualizacji stanu</td></tr>
                          <tr><td>meta/error</td><td>(opcjonalnie) metadane / flaga b≈Çƒôdu</td></tr>
                        </tbody>
                      </table>
                    </div>
                  </foreignObject>
                </g>

                <g class="ok" transform="translate(520,60)">
                  <rect width="450" height="160" rx="10"></rect>
                  <text x="12" y="30">Przyk≈Çady</text>
                  <text x="12" y="60" class="muted">{ type: 'INCREMENT' }</text>
                  <text x="12" y="90" class="muted">{ type: 'ADD_TODO', payload: { id: 1, text: 'Naucz siƒô Redux' } }</text>
                  <text x="12" y="120" class="muted">{ type: 'SET_FILTER', payload: 'active' }</text>
                </g>
              </g>
            </svg>
          </div>
        </details>

        <p>W powy≈ºszym przyk≈Çadzie mamy dwie akcje: <code>increment</code> i <code>decrement</code>, kt√≥re s≈Çu≈ºƒÖ do zmiany stanu licznika.</p>

        <h2>Reducery</h2>
        <p>Reducer to funkcja, kt√≥ra przyjmuje obecny stan i akcjƒô, a nastƒôpnie zwraca nowy stan w zale≈ºno≈õci od typu akcji. Reducer jest odpowiedzialny za przetwarzanie akcji i aktualizacjƒô stanu.</p>

        <pre><code class="language-javascript">
const initialState = { count: 0 };

function counterReducer(state = initialState, action) {
    switch (action.type) {
        case 'INCREMENT':
            return { ...state, count: state.count + 1 };
        case 'DECREMENT':
            return { ...state, count: state.count - 1 };
        default:
            return state;
    }
}

export default counterReducer;
        </code></pre>

        <details>
          <summary class="viz-title">‚öôÔ∏è Wizualizacja: czysta funkcja reducer</summary>
          <div class="viz-wrap">
            <svg viewBox="0 0 1000 360" class="viz-svg" aria-label="Reducer pure function">
              <defs>
                <marker id="arr-reducer" markerWidth="12" markerHeight="12" refX="10" refY="6" orient="auto">
                  <path d="M0,0 L12,6 L0,12 Z" fill="#94a3b8"></path>
                </marker>
              </defs>
              <g class="lane" transform="translate(10,10)">
                <rect width="980" height="340" rx="12"></rect>
                <text x="16" y="28" class="lane-title">state + action ‚Üí reducer ‚Üí newState</text>

                <g class="node" transform="translate(20,80)">
                  <rect width="240" height="60" rx="10"></rect>
                  <text x="12" y="24">state: { count: 0 }</text>
                </g>
                <g class="node" transform="translate(20,170)">
                  <rect width="240" height="60" rx="10"></rect>
                  <text x="12" y="24">action: { type: 'INCREMENT' }</text>
                </g>

                <path class="arrow" d="M260,110 L430,110" marker-end="url(#arr-reducer)"/>
                <path class="arrow" d="M260,200 L430,200" marker-end="url(#arr-reducer)"/>

                <g class="pill" transform="translate(430,80)">
                  <rect width="220" height="150" rx="10"></rect>
                  <text x="12" y="26">counterReducer</text>
                  <text x="12" y="52" class="muted">switch(action.type)</text>
                  <text x="12" y="78" class="muted">zwr√≥ƒá NOWY obiekt stanu</text>
                </g>

                <path class="arrow" d="M650,155 L920,155" marker-end="url(#arr-reducer)"/>
                <g class="ok" transform="translate(680,120)">
                  <rect width="280" height="70" rx="10"></rect>
                  <text x="12" y="26">newState: { count: 1 }</text>
                  <text x="12" y="48" class="muted">immutability</text>
                </g>

                <g transform="translate(20,260)">
                  <foreignObject width="940" height="60">
                    <div xmlns="http://www.w3.org/1999/xhtml">
                      <p class="small">Reducer jest <strong>czysty</strong>: bez efekt√≥w ubocznych, nie mutuje argument√≥w, ten sam input ‚Üí ten sam output.</p>
                    </div>
                  </foreignObject>
                </g>
              </g>
            </svg>
          </div>
        </details>

        <p>W powy≈ºszym przyk≈Çadzie <code>counterReducer</code> zwiƒôksza lub zmniejsza warto≈õƒá <code>count</code> w zale≈ºno≈õci od typu akcji.</p>

        <h2>≈ÅƒÖczenie Redux z React</h2>
        <p>Aby korzystaƒá z Redux w komponentach React, musimy opakowaƒá aplikacjƒô w <code>Provider</code> oraz u≈ºyƒá hook√≥w <code>useSelector</code> i <code>useDispatch</code> do uzyskiwania dostƒôpu do stanu i wywo≈Çywania akcji.</p>

        <pre><code class="language-javascript">
import React from 'react';
import { Provider } from 'react-redux';
import store from './store';
import Counter from './Counter';

function App() {
    return (
        &lt;Provider store={store}&gt;
            &lt;Counter /&gt;
        &lt;/Provider&gt;
    );
}

export default App;
        </code></pre>

        <details>
          <summary class="viz-title">üå≥ Wizualizacja: Provider przekazuje store w d√≥≈Ç drzewa</summary>
          <div class="viz-wrap">
            <svg viewBox="0 0 1000 420" class="viz-svg" aria-label="Provider context">
              <g class="lane" transform="translate(10,10)">
                <rect width="980" height="400" rx="12"></rect>
                <text x="16" y="28" class="lane-title">&lt;Provider store={store}&gt; ‚Ä¶ &lt;/Provider&gt;</text>

                <g class="ok" transform="translate(20,60)">
                  <rect width="940" height="70" rx="10"></rect>
                  <text x="12" y="26">Provider (Context)</text>
                  <text x="12" y="48" class="muted">udostƒôpnia jeden store dla ca≈Çej aplikacji</text>
                </g>

                <g class="node" transform="translate(40,160)">
                  <rect width="260" height="60" rx="10"></rect>
                  <text x="12" y="24">Navbar</text>
                </g>
                <g class="node" transform="translate(370,160)">
                  <rect width="260" height="60" rx="10"></rect>
                  <text x="12" y="24">Counter</text>
                </g>
                <g class="node" transform="translate(700,160)">
                  <rect width="260" height="60" rx="10"></rect>
                  <text x="12" y="24">OtherPage</text>
                </g>

                <g class="pill" transform="translate(370,250)">
                  <rect width="260" height="60" rx="10"></rect>
                  <text x="12" y="24">useSelector / useDispatch</text>
                </g>

                <g transform="translate(40,330)">
                  <foreignObject width="920" height="60">
                    <div xmlns="http://www.w3.org/1999/xhtml">
                      <p class="small">Ka≈ºdy komponent w drzewie mo≈ºe pobraƒá stan i wys≈Çaƒá akcjƒô, bez rƒôcznego przekazywania props.</p>
                    </div>
                  </foreignObject>
                </g>
              </g>
            </svg>
          </div>
        </details>

        <p>Komponent <code>Provider</code> dostarcza store do wszystkich komponent√≥w wewnƒÖtrz aplikacji.</p>

        <h2>U≈ºycie useSelector i useDispatch</h2>
        <p>Hook <code>useSelector</code> pozwala na pobieranie stanu z magazynu, a <code>useDispatch</code> umo≈ºliwia wysy≈Çanie akcji.</p>

        <pre><code class="language-javascript">
import React from 'react';
import { useSelector, useDispatch } from 'react-redux';
import { increment, decrement } from './actions';

function Counter() {
    const count = useSelector((state) => state.count);
    const dispatch = useDispatch();

    return (
        &lt;div&gt;
            &lt;p&gt;Licznik: {count}&lt;/p&gt;
            &lt;button onClick={() =&gt; dispatch(increment())}&gt;Zwiƒôksz&lt;/button&gt;
            &lt;button onClick={() =&gt; dispatch(decrement())}&gt;Zmniejsz&lt;/button&gt;
        &lt;/div&gt;
    );
}

export default Counter;
        </code></pre>

        <details open>
          <summary class="viz-title">üîÅ Wizualizacja: pe≈Çny cykl ‚Äì klik ‚Üí dispatch ‚Üí reducer ‚Üí UI</summary>
          <div class="viz-wrap">
            <svg viewBox="0 0 1000 520" class="viz-svg" aria-label="Przep≈Çyw Redux">
              <defs>
                <marker id="arr-flow" markerWidth="12" markerHeight="12" refX="10" refY="6" orient="auto">
                  <path d="M0,0 L12,6 L0,12 Z" fill="#94a3b8"></path>
                </marker>
              </defs>

              <g class="lane" transform="translate(10,10)">
                <rect width="980" height="500" rx="12"></rect>
                <text x="16" y="28" class="lane-title">Interakcja u≈ºytkownika aktualizuje stan i od≈õwie≈ºa UI</text>

                <g class="node" transform="translate(20,70)">
                  <rect width="300" height="60" rx="10"></rect>
                  <text x="12" y="24">UI: klik ‚ÄûZwiƒôksz‚Äù</text>
                </g>

                <path class="arrow" d="M320,100 L500,100" marker-end="url(#arr-flow)"/>

                <g class="pill" transform="translate(500,70)">
                  <rect width="220" height="60" rx="10"></rect>
                  <text x="12" y="24">dispatch({type:'INCREMENT'})</text>
                </g>

                <path class="arrow" d="M720,100 L900,100" marker-end="url(#arr-flow)"/>

                <g class="ok" transform="translate(720,160)">
                  <rect width="260" height="60" rx="10"></rect>
                  <text x="12" y="24">store ‚Üí reducer</text>
                </g>

                <path class="arrow" d="M850,220 L850,280" marker-end="url(#arr-flow)"/>

                <g class="ok" transform="translate(680,280)">
                  <rect width="300" height="60" rx="10"></rect>
                  <text x="12" y="24">newState: { count: 1 }</text>
                </g>

                <path class="arrow" d="M680,310 L500,310" marker-end="url(#arr-flow)"/>
                <g class="node" transform="translate(420,270)">
                  <rect width="240" height="60" rx="10"></rect>
                  <text x="12" y="24">react-redux powiadamia subskrybent√≥w</text>
                </g>

                <path class="arrow" d="M420,300 L200,300" marker-end="url(#arr-flow)"/>
                <g class="ok" transform="translate(20,270)">
                  <rect width="180" height="60" rx="10"></rect>
                  <text x="12" y="24">UI re-render</text>
                </g>

                <g transform="translate(20,360)">
                  <foreignObject width="940" height="120">
                    <div xmlns="http://www.w3.org/1999/xhtml">
                      <table class="db-table">
                        <caption class="mini">Hooki w akcji</caption>
                        <thead><tr><th>Hook</th><th>Co robi?</th><th>Wskaz√≥wka</th></tr></thead>
                        <tbody>
                          <tr><td>useSelector(sel)</td><td>Subskrybuje store i zwraca wycinek stanu</td><td>Selector powinien byƒá czysty i szybki</td></tr>
                          <tr><td>useDispatch()</td><td>Zwraca funkcjƒô do dispatchowania akcji</td><td>Mo≈ºesz bindowaƒá action creatory</td></tr>
                        </tbody>
                      </table>
                    </div>
                  </foreignObject>
                </g>
              </g>
            </svg>
          </div>
        </details>

        <p>W przyk≈Çadzie powy≈ºej <code>useSelector</code> pobiera warto≈õƒá licznika, a <code>useDispatch</code> umo≈ºliwia wys≈Çanie akcji <code>increment</code> lub <code>decrement</code>.</p>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-javascript.min.js"></script>

    <!-- Lekki, izolowany CSS do wizualizacji (pe≈Çna szeroko≈õƒá + responsywno≈õƒá) -->
    <style>
      /* Pe≈Çna szeroko≈õƒá dla sekcji wizualizacji */
      details, .viz-wrap { width:100%; max-width:none !important; }
      .viz-title{cursor:pointer;font-weight:600}
      .viz-wrap{padding:.5rem .25rem}

      /* Responsywne SVG */
      .viz-svg{display:block;width:100% !important;max-width:100% !important;height:auto !important;background:#0e1729;border-radius:12px}

      /* Bloki / kolory */
      .lane rect{fill:#0f172a;stroke:#1f2937}
      .lane-title{fill:#cbd5e1;font-weight:600}
      .node rect{fill:#111827;stroke:#334155}
      .pill rect{fill:#0b3b2e;stroke:#14532d}
      .ok rect{fill:#0b2a3b;stroke:#0e7490}
      .warn rect{fill:#3b0b0b;stroke:#7f1d1d}
      .node text,.pill text,.ok text,.warn text{fill:#e2e8f0;font-size:14px}
      .muted{fill:#94a3b8;font-size:12px}

      /* Strza≈Çki */
      .arrow{stroke:#94a3b8;stroke-width:2;fill:none}

      /* Tabele i layout */
      .db-table{width:100% !important;max-width:100% !important;border-collapse:collapse;margin:.5rem 0;table-layout:fixed}
      .db-table th,.db-table td{border:1px solid #aeaeae;padding:.5rem .65rem;text-align:left;vertical-align:top;word-break:break-word}
      .db-table th{background:#0e1729;color:#dbe2ea}
      .mini{color:#a7b0be;font-size:.95rem}

      /* Kod ‚Äì pe≈Çna szeroko≈õƒá + przewijanie poziome w razie potrzeby */
      pre[class*="language-"]{width:100% !important;max-width:none !important;box-sizing:border-box;overflow-x:auto;white-space:pre}
      code[class*="language-"]{white-space:pre}
    </style>
</body>
</html>
